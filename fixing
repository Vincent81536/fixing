Reanimate = getgenv().Framework
local Character = nil

if Reanimate == "Hatless" then
local Hatless = loadstring(game:HttpGet("https://raw.githubusercontent.com/Vincent81536/hatless/refs/heads/main/hatless"))()
Character = Hatless.FakeCharacter
elseif getgenv().Framework == "Krypton" then
    repeat task.wait() until game:IsLoaded()
    local p = game:GetService("Players").LocalPlayer
    local c = p.Character or p.CharacterAdded:Wait()
    c.Archivable = true

    local function limb(name, mesh, tex, limb)
        local a = Instance.new("Accessory")
        a.Name = name
        local h = Instance.new("Part")
        h.Name = "Handle"
        h.Size = Vector3.new(1,1,1)
        h.Transparency = 1
        h.CanCollide = false
        h.Massless = true
        h.Parent = a

        local m = Instance.new("SpecialMesh", h)
        m.MeshId = "rbxassetid://"..mesh
        m.TextureId = "rbxassetid://"..tex

        a.Parent = c
        local t = c:FindFirstChild(limb)
        if not t then return end

        local att1 = Instance.new("Attachment", h)
        local att2 = Instance.new("Attachment", t)

        local ap = Instance.new("AlignPosition", h)
        ap.Attachment0 = att1
        ap.Attachment1 = att2
        ap.RigidityEnabled = true
        ap.Responsiveness = 200
        ap.MaxForce = 999999999

        local ao = Instance.new("AlignOrientation", h)
        ao.Attachment0 = att1
        ao.Attachment1 = att2
        ao.RigidityEnabled = true
        ao.Responsiveness = 200
        ao.MaxTorque = 999999999
    end

    -- Fake rig Krypton limbs
    limb("Torso","127552124837034","131014325980101","UpperTorso")
    limb("LeftArm","127552099169285","131014351553580","LeftUpperArm")
    limb("RightArm","127552092594828","131014345438214","RightUpperArm")
    limb("LeftLeg","127552109145440","131014333823383","LeftUpperLeg")
    limb("RightLeg","127552103249321","131014329470411","RightUpperLeg")
end

-- YES I KNOW ABOVE IS TERRIBLE PLS STOP REMINDING ME ðŸ˜­ 

local RootPart = Character.HumanoidRootPart
local Jumped,Falled,Idled,Walked = false,false,false,false
local AnimatorModule = loadstring(game:HttpGet("https://raw.githubusercontent.com/Vincent81536/AnimatorModule/refs/heads/main/AnimatorModule"))()
local Anims = Instance.new("Folder", workspace)


local function SafeCheckGroundPosition()
    if RootPart.Position.Y < -5 then -- adjust this Y threshold if needed
        RootPart.CFrame = CFrame.new(RootPart.Position.X, 5, RootPart.Position.Z)
    end
end

function Raycast(POSITION, DIRECTION, RANGE, IGNOREDECENDANTS)
return workspace:FindPartOnRay(Ray.new(POSITION, DIRECTION.unit * RANGE), IGNOREDECENDANTS)
end

function LoadAnim(Rig, KeyFrameS)
if not AnimatorModule[Rig] then
AnimatorModule[Rig] = {}
end
AnimatorModule[Rig][KeyFrameS.Name] = AnimatorModule:LoadAnimation(Rig, KeyFrameS)
end

function PlayAnim(Rig, Animation, AnimFade, AnimSpeed)
if not AnimatorModule[Rig] then
AnimatorModule[Rig] = {}
end
if not AnimatorModule[Rig][Animation.Name] then
AnimatorModule[Rig][Animation.Name] = AnimatorModule:LoadAnimation(Rig, Animation)
end
for Animation, Track in next, AnimatorModule[Rig] do
if Animation ~= Animation.Name then
Track:Stop()
end
end
if not AnimatorModule[Rig][Animation.Name].IsPlaying then
AnimatorModule[Rig][Animation.Name]:Play(AnimFade or 1, AnimSpeed or 1)
end
end

function StopAnim(Rig, Anim)
if not AnimatorModule[Rig] then
AnimatorModule[Rig] = {}
end
if not AnimatorModule[Rig][Anim.Name] then
AnimatorModule[Rig][Anim.Name] = AnimatorModule:LoadAnimation(Rig, Anim)
end
AnimatorModule[Rig][Anim.Name]:Stop()
end

function CreateAnimation(Name, ID)
local New = game:GetObjects("rbxassetid://"..ID)[1]
New.Parent = Anims
New.Name = Name
end

if game.CoreGui:FindFirstChild("FluxLib") then
game.CoreGui:FindFirstChild("FluxLib"):Destroy()
end

local Lib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Vincent81536/hub/main/hubtest"))()
local GUI = Lib:Window("Disbelief Hub", "Irony at its finest.", Color3.fromRGB(0, 0, 0), Enum.KeyCode.LeftControl)
-- â¬‡ï¸ Center GUI when it spawns
task.delay(0.5, function()
    local fluxUI = game.CoreGui:FindFirstChild("FluxLib")
    if fluxUI and fluxUI:FindFirstChild("Main") then
        fluxUI.Main.Position = UDim2.new(0.5, -fluxUI.Main.Size.X.Offset/2, 0.5, -fluxUI.Main.Size.Y.Offset/2)
    end
end)
local DancesA = GUI:Tab("Animations - R6 Dances", "http://www.roblox.com/asset/?id=6023426915")
local DancesB = GUI:Tab("Animations - Forsaken", "http://www.roblox.com/asset/?id=6023426915")

local R6Dances = {
{Name = "Idle", ID = 132196401232277},
{Name = "Boombox Dance", ID = 84471848998012, SoundID = 1839931160},
{Divider = true},  
{Name = "Cafeteria", ID = 111079857314277},
{Name = "Swag Surfin'", ID = 88245814842699},
{Name = "Trinidad", ID = 125079877993376},
{Name = "Rat Dance", ID = 98260902889120},
{Name = "Internet Yamero", ID = 99905571448278},
{Name = "Two", ID = 137845929482571},
{Name = "Hakari", ID = 92699725136780},
{Name = "Hakari V2", ID = 139107159497423, Speed = 3},
{Name = "Heavy Love", ID = 85856686932206},
{Name = "Oh Who Is You", ID = 80777442674443},
{Name = "BHop", ID = 82234401429055},
{Name = "Boomin'", ID = 135207682507735},
{Name = "Carbohydrate Craving", ID = 77887053847258},
{Name = "Criss Cross Toprock", ID = 73116243097694},
{Name = "Deep Fried Desire", ID = 127846780529069},
{Name = "Downtown Funk", ID = 103059790868580},
{Name = "Dragon of Dojima", ID = 79052669998148},
{Name = "Fighter Stance", ID = 118865990558686},
{Name = "Hot Springs", ID = 134527716461262},
{Name = "Kombonk", ID = 88519824673842},
{Name = "PoPiPo Extended", ID = 115465103089127},
{Name = "Rage", ID = 97891561277088},
{Name = "Shadow Dash", ID = 126495344868322},
{Name = "Star Striker", ID = 126271443897103},
{Name = "Survivalist", ID = 74820723472974},
{Divider = true},  
{Name = "Appendum", ID = 77926650795117},
{Name = "Attitude", ID = 129169655004423},
{Divider = true},  
{Name = "Bill", ID = 120460931637912},
{Name = "Billie Jean", ID = 108805310510119},
{Name = "Billy Bounce", ID = 125962207089467},
{Name = "Bit Crushing", ID = 135845625327739},
{Name = "Black and Yellow", ID = 132028118802766},
{Name = "Blinding Lights", ID = 83245497290837},
{Name = "BloodPop", ID = 132026285699359},
{Name = "Bomb Monkey", ID = 75616586799217},
{Name = "Boogie", ID = 125356421399032},
{Name = "Boogie Bomb", ID = 114817849347144},
{Name = "Boogie Down", ID = 77558722177080, Speed = 0.85},
{Name = "Boomin'", ID = 135207682507735},
{Name = "Box Swing", ID = 75405139558088, Speed = 0.75},
{Name = "BreakDance", ID = 132886479585903},
{Name = "BreakDance 2005", ID = 131296257768627},
{Name = "Break Down", ID = 100568904650591},
{Name = "Breakin", ID = 131155721688011},
{Name = "Bullet Dodge Ballet", ID = 98779400840597},
{Divider = true},  
{Name = "Calamity", ID = 102026644002108},
{Name = "Caramelldansen", ID = 103597509139287},
{Name = "ChaseMe", ID = 118311613925473},
{Name = "Check", ID = 132280062505986},
{Name = "Chicken Dinner", ID = 100643285137768},
{Name = "Club Penguin", ID = 89761302048916},
{Name = "Colossal", ID = 93170660505618},
{Name = "Company Jig", ID = 116614992219971},
{Name = "Conga", ID = 115557579308566},
{Name = "Continental Drift", ID = 105174222033892},
{Name = "CrackDown", ID = 133188222109902},
{Name = "Crank Dat", ID = 139148388599834},
{Name = "Cyber Bop", ID = 129655276640546},
{Name = "CupCakes", ID = 117125226382337},
{Divider = true},  
{Name = "Direction Directive", ID = 100131309856257},
{Name = "Domino", ID = 126683576461381, Speed = 0.75},
{Name = "Doodle", ID = 90069083924245, Speed = 0.75},
{Name = "Doom MCBringer", ID = 123386245117713},
{Name = "Double Step", ID = 138112012258643},
{Name = "Downtown Funk", ID = 103059790868580},
{Name = "Dragon Dance", ID = 75687257387850, Speed = 0.75},
{Name = "Drip", ID = 100177280567649, Speed = 0.75},
{Name = "Drum Major", ID = 116369780386936},
{Name = "Dynamic Shuffle", ID = 78337295886429},
{Divider = true},  
{Name = "Electro Shuffle", ID = 136684924748195},
{Name = "Electro Swing", ID = 93684150668786},
{Name = "Entranced", ID = 131726076631029},
{Divider = true},  
{Name = "Fein", ID = 115727639577589},
{Name = "Flamenco", ID = 112606613683393},
{Name = "Flapper", ID = 123373225244443},
{Name = "Floss", ID = 107287295776925},
{Name = "Fly Dance", ID = 125627676172807},
{Name = "Free Flow", ID = 101564911432113},
{Name = "Friday Night", ID = 91741353599946},
{Name = "Friday Funk", ID = 70835462045983},
{Name = "Frozen Pizza", ID = 78457500452351},
{Name = "Funky Jig", ID = 104720694407943},
{Divider = true},  
{Name = "Gangnam Style", ID = 109451974680631},
{Name = "Garrys Dance", ID = 102655274160157},
{Name = "Get Sturdy", ID = 77773358394206},
{Name = "Get to the Top", ID = 93228901518812},
{Name = "Goat Simulator", ID = 129327004786530},
{Name = "Groovy", ID = 88997109090699},
{Divider = true},  
{Name = "HanSolo", ID = 84236497616039},
{Name = "Heeltoe Hop", ID = 98256622649150},
{Name = "Heeltoe Toprock", ID = 140670228658366},
{Name = "Hiphop Hero", ID = 129871001094710},
{Name = "HipShop", ID = 103112841595182},
{Name = "HolIDay", ID = 85998810156809},
{Divider = true},  
{Name = "Infectious", ID = 103230323718650},
{Name = "Insanity", ID = 139483347792972},
{Name = "Its Complicated", ID = 78717948152747},
{Divider = true},  
{Name = "JayWalking", ID = 107833895457998, Speed = 0.85},
{Name = "Jive", ID = 133324659811186, Speed = 0.75},
{Name = "JumpStyle", ID = 115620519702324, Speed = 0.75},
{Name = "Jumping Jacks", ID = 86279418149917},
{Name = "Jung Justice", ID = 71723925114737},
{Divider = true},  
{Name = "Kalyx", ID = 137738597810830},
{Name = "Kazotsky Kick", ID = 114036336168567},
{Name = "KeepUp", ID = 84765927391240, Speed = 0.65},
{Name = "Kombonk", ID = 88519824673842, Speed = 0.75},
{Name = "KrabBorg", ID = 84670621089927},
{Divider = true},  
{Name = "Lagtrain", ID = 80764093560475},
{Name = "Legal Reasons", ID = 78083829137149},
{Name = "Lets Groove", ID = 109923692577857},
{Name = "Little Big", ID = 78546390232203},
{Name = "Lofi Headbang", ID = 84024656726416},
{Name = "Love Hate", ID = 118446506171691},
{Divider = true},  
{Name = "Magnetic", ID = 91594002186875},
{Name = "MannRobics", ID = 137456359844967},
{Name = "MaxEffort", ID = 108526381474779},
{Name = "Miku", ID = 82171050414030},
{Name = "Million", ID = 109123683211464},
{Name = "Mirage", ID = 108895956412207},
{Name = "Mischiev Function", ID = 100305033962391, Speed = 0.95},
{Divider = true},  
{Name = "Neo", ID = 100305033962391},
{Name = "Nerdy", ID = 136250600208499},
{Name = "NewDonk", ID = 111542909088526},
{Name = "New Jack Swingin", ID = 113494131456426},
{Divider = true},  
{Name = "Oddloop", ID = 95650849617284},
{Name = "Oktober Aid", ID = 127865309658292},
{Name = "Old School", ID = 115558885277292},
{Name = "Outlaw", ID = 79048566727283},
{Name = "OverDrive", ID = 118789281098407},
{Divider = true},  
{Name = "PonPon", ID = 109617660580282},
{Name = "Party House", ID = 113030438875320},
{Name = "Peanut Butter", ID = 85717017003584},
{Name = "Pick it Up", ID = 106248669913767},
{Name = "PoPiPo", ID = 115465103089127},
{Name = "Pogo", ID = 109001339891602},
{Name = "Pop and Lock", ID = 113869158054586},
{Name = "PopLock", ID = 83789802032942},
{Name = "Prince of Egypt", ID = 95986135548450},
{Name = "Professional", ID = 117672863086140},
{Divider = true},  
{Name = "Rain Check", ID = 104145748528942},
{Name = "Reanimated", ID = 135638372997121},
{Name = "Reflex", ID = 104246452023047},
{Name = "Reject Step", ID = 79440368381920},
{Name = "Rewind", ID = 85595451831140},
{Name = "RicFlair", ID = 77103786363593},
{Name = "Ridin It", ID = 110739557877639},
{Name = "Rodeo", ID = 139177767291866},
{Name = "Royal Angst", ID = 101917046845862},
{Name = "Running in Terror", ID = 82063943309833},
{Divider = true},  
{Name = "Scenario", ID = 105424478944256},
{Name = "Sicko Mode", ID = 82639898531456},
{Name = "Side Shuffle", ID = 106696831887022},
{Name = "Sidestep", ID = 118256299900662},
{Name = "Sit", ID = 77436653907705},
{Name = "Slick", ID = 112642355788128},
{Name = "Slow Down", ID = 96225967263351},
{Name = "Smooth Slide", ID = 95051030054364},
{Name = "SoarAbove", ID = 92031051557681, Speed = 0.75},
{Name = "SpongeBob", ID = 107928348961439, Speed = 0.75},
{Name = "SpringLoaded", ID = 126001082682364},
{Name = "Springy", ID = 96915228320599},
{Name = "Squash and Stretch", ID = 82430103452187},
{Name = "Stock Shuffle", ID = 86067433847393},
{Divider = true},  
{Name = "TaiChi", ID = 139334740822475},
{Name = "Texas Hoedown", ID = 130942516783083},
{Name = "The Flop", ID = 122878040721056},
{Name = "The MD", ID = 103541609182057},
{Name = "The Roll", ID = 70422527184550},
{Name = "Thriller", ID = 101170440834154},
{Name = "Too Much Brain", ID = 71228444263749},
{Name = "Tootsee Roll", ID = 102931874666964},
{Name = "Top Rocking", ID = 116248187570378},
{Name = "True Heart", ID = 139400505188520},
{Name = "Turnt Up", ID = 95604282742916},
{Divider = true},  
{Name = "Walk Of Pride", ID = 137503210275698},
{Name = "Wednesday", ID = 93029240528390},
{Name = "Well Rounded", ID = 93832203745642},
{Name = "Work It", ID = 140046429691095},
{Divider = true},  
{Name = "XO", ID = 73559770055600},
{Divider = true},  
{Name = "Zombeat", ID = 130481163326164},
{Divider = true},  
{Name = "Victory Sway", ID = 118331988473361},
{Divider = true},  
{Name = "ah yes", ID = 121084882913556},
{Name = "expldoe", ID = 113901618647384},
{Divider = true},  
{Name = "Club Penguin 2", ID = 116538780276427},
{Name = "Garry's Dance 2", ID = 116538780276427},
{Name = "Goat Simulator 2", ID = 108846628611129},
{Name = "PoPiPo 2", ID = 108846628611129},
{Divider = true},  
}

local Forsaken = {
{Name = "Idle", ID = 132196401232277},
{Name = "KJ Dropkick", ID = 17354976067},
{Name = "Shucks", ID = 74238051754912},
{Name = "Silly Billy", ID = 107464355830477},
{Name = "Subterfuge", ID = 87482480949358},
{Name = "Richard Watterson (the hero)", ID = 74012585744751},
{Name = "Immaterial", ID = 90127032448242},
{Name = "Run away", ID = 131562546189485},
{Name = "Run away V2", ID = 119147810948063},
{Name = "Headlock", ID = 97992194141034},
{Name = "Gangdance", ID = 121267065315946},
{Name = "Bluelock", ID = 76975616044095},
{Name = "Headlock V2", ID = 110536141087568},
{Name = "Dip", ID = 103112841595182},
{Name = "Simple", ID = 95650849617284},
{Name = "So Retro", ID = 125239534389442},
{Name = "Mafiosos hat ", ID = 108665782885630},
{Name = "Mafiosos dance ", ID = 76038781746720},
{Name = "Mafiosos hit ", ID = 71308482162106},
}

for i, v in pairs(Forsaken) do
if v.Divider then
DancesB:Line()
else
DancesB:Button(v.Name, v.Name, function()
if not Anims:FindFirstChild(v.Name) then
CreateAnimation(v.Name, v.ID)
end
PlayAnim(Character, Anims[v.Name], 0, v.Speed or 1)
end)
end
end

for i, v in pairs(R6Dances) do
if v.Divider then
DancesA:Line()
else
DancesA:Button(v.Name, v.Name, function()
if not Anims:FindFirstChild(v.Name) then
CreateAnimation(v.Name, v.ID)
end
PlayAnim(Character, Anims[v.Name], 0, v.Speed or 1)
end)
end
end

CreateAnimation("Idle", 132196401232277)
CreateAnimation("Walk", 96901225702491)
CreateAnimation("Jump", 103148094958443)
CreateAnimation("Fall", 90270295182351)

game:GetService("RunService").Heartbeat:Connect(function()
for i,v in pairs(Character:FindFirstChildOfClass("Humanoid"):GetPlayingAnimationTracks()) do
v:Stop(0)
end
local HitFloor,HitPosition = Raycast(RootPart.Position, (CFrame.new(RootPart.Position, RootPart.Position + Vector3.new(0, -1, 0))).LookVector, 4, Character)
TorsoVelocity = (RootPart.Velocity).Magnitude
TorsoVerticalVelocity = RootPart.Velocity.Y
if TorsoVerticalVelocity > 1 and HitFloor == nil then
if Jumped == false then
Jumped = true
PlayAnim(Character, Anims.Jump, 0.1, 1)
end
Falled = false
Idled = false
Walked = false
StopAnim(Character, Anims.Fall)
StopAnim(Character, Anims.Idle)
StopAnim(Character, Anims.Walk)
elseif TorsoVerticalVelocity < 1 and HitFloor == nil then
if Falled == false then
Falled = true
PlayAnim(Character, Anims.Fall, 0.1, 1)
end		
Jumped = false
Idled = false
Walked = false
StopAnim(Character, Anims.Jump)
StopAnim(Character, Anims.Idle)
StopAnim(Character, Anims.Walk)
elseif TorsoVelocity < 1 and HitFloor ~= nil then
if Idled == false then
Idled = true
PlayAnim(Character, Anims.Idle, 0.1, 0.1)
end
Jumped = false
Falled = false
Walked = false
StopAnim(Character, Anims.Jump)
StopAnim(Character, Anims.Fall)
StopAnim(Character, Anims.Walk)
elseif TorsoVelocity > 1 and HitFloor ~= nil then
if Walked == false then
Walked = true
PlayAnim(Character, Anims.Walk,0.1,1)
end
Jumped = false
Falled = false
Idled = false
StopAnim(Character, Anims.Jump)
StopAnim(Character, Anims.Fall)
StopAnim(Character, Anims.Idle)
end
end)


warn[[
Tapping microphone "Hello?, helloooo?? Is this thing on?" â€”static crackles- â€œAh, there we go. Ladies and gentlemen! Welcome to the hit show 'No One Can Prove Melon Is A Skid!' Fasten your seat belts; what youâ€™re about to hear could turn the world upside down.
â€œFor our first guest today, we haveâ€¦uh â€“wait, what was the name again?â€ â€”shuffling papersâ€” "Ah, yes! The respected keyboard warrior who genuinely thinks they have discovered the biggest scandal in the world of scripting! Tell us sir, what revolutionary evidence that you have today?
â€”awkward silenceâ€” "Oh? Nothing? No proof? Just vibes? Fascinating. Truly groundbreaking investigative work."
So, people, here you go. Another â€˜Baseless Accusations & Keyboard Rage!â€˜ episode. Stay tuned because we are heading straight into the mind-blowing world of â€˜People Who Think Copy-Pasting a GitHub Repo Makes Them Elite Hackers!â€
â€”applause track plays â€“ Until next time!
]]



-- Register the Run animation
CreateAnimation("Run", 96901225702491)

-- Track run state
local isRunning = false
local Humanoid = Character:FindFirstChildOfClass("Humanoid")

-- Persistent GUI for Run Toggle
local function createRunToggleUI()
    if game.CoreGui:FindFirstChild("RunToggleUI") then
        game.CoreGui.RunToggleUI:Destroy()
    end

    local RunToggleUI = Instance.new("ScreenGui")
    RunToggleUI.Name = "RunToggleUI"
    RunToggleUI.ResetOnSpawn = false
    RunToggleUI.Parent = game.CoreGui

    local RunButton = Instance.new("TextButton")
    RunButton.Size = UDim2.new(0, 100, 0, 40)
    RunButton.Position = UDim2.new(0, 20, 0.5, 0)
    RunButton.Text = "Run"
    RunButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    RunButton.TextColor3 = Color3.new(1, 1, 1)
    RunButton.Font = Enum.Font.GothamBold
    RunButton.TextSize = 18
    RunButton.Draggable = true
    RunButton.Active = true
    RunButton.Parent = RunToggleUI

    RunButton.MouseButton1Click:Connect(function()
	isRunning = not isRunning
	RunButton.Text = isRunning and "Walk" or "Run"
	Humanoid.WalkSpeed = isRunning and 30 or 16

	-- Immediately play run animation if toggled and moving
	if isRunning and Humanoid.MoveDirection.Magnitude > 0 then
		StopAnim(Character, Anims.Walk)
		PlayAnim(Character, Anims.Run, 0.1, 1)
	elseif not isRunning and Humanoid.MoveDirection.Magnitude > 0 then
		StopAnim(Character, Anims.Run)
		PlayAnim(Character, Anims.Walk, 0.1, 1)
	end
end)

end

createRunToggleUI()

-- âœ… Register attack animation
CreateAnimation("Mafiosos hit ", 71308482162106)

local Players = game:GetService("Players")
local player = Players.LocalPlayer

local function createAttackUI()
    if game.CoreGui:FindFirstChild("AttackUI") then
        game.CoreGui.AttackUI:Destroy()
    end

    local AttackUI = Instance.new("ScreenGui")
    AttackUI.Name = "AttackUI"
    AttackUI.ResetOnSpawn = false
    AttackUI.Parent = game.CoreGui

    local AttackButton = Instance.new("TextButton")
    AttackButton.Size = UDim2.new(0, 100, 0, 40)
    AttackButton.Position = UDim2.new(0, 140, 0.5, 0)
    AttackButton.Text = "Attack"
    AttackButton.BackgroundColor3 = Color3.fromRGB(120, 0, 0)
    AttackButton.TextColor3 = Color3.new(1, 1, 1)
    AttackButton.Font = Enum.Font.GothamBold
    AttackButton.TextSize = 18
    AttackButton.Active = true
    AttackButton.Draggable = true
    AttackButton.Parent = AttackUI

    AttackButton.MouseButton1Click:Connect(function()
        PlayAnim(Character, Anims["Mafiosos hit "], 0.1, 1)
    end)

    local humanoid = Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        humanoid.Died:Connect(function()
            if AttackUI then
                AttackUI:Destroy()
            end
        end)
    end
end

-- Create the button now, and re-create on respawn
player.CharacterAdded:Connect(function(char)
    Character = char
    task.wait(0.5)
    createAttackUI()
end)

if player.Character then
    task.wait(0.5)
    createAttackUI()
end
-- Modify heartbeat to play run animation only during movement if run mode is enabled
game:GetService("RunService").Heartbeat:Connect(function()
    for _, v in pairs(Humanoid:GetPlayingAnimationTracks()) do
        v:Stop(0)
    end

    local HitFloor = Raycast(RootPart.Position, Vector3.new(0, -1, 0), 4, Character)
    local TorsoVelocity = RootPart.Velocity.Magnitude
    local TorsoVerticalVelocity = RootPart.Velocity.Y

    if TorsoVerticalVelocity > 1 and not HitFloor then
        if not Jumped then
            Jumped = true
            PlayAnim(Character, Anims.Jump, 0.1, 1)
        end
        Falled, Idled, Walked = false, false, false
    elseif TorsoVerticalVelocity < 1 and not HitFloor then
        if not Falled then
            Falled = true
            PlayAnim(Character, Anims.Fall, 0.1, 1)
        end
        Jumped, Idled, Walked = false, false, false
    elseif TorsoVelocity < 1 and HitFloor then
        if not Idled then
            Idled = true
            PlayAnim(Character, Anims.Idle, 0.1, 0.1)
        end
        Jumped, Falled, Walked = false, false, false
    elseif TorsoVelocity > 1 and HitFloor then
        if isRunning then
            if not Walked then
                Walked = true
                PlayAnim(Character, Anims.Run, 0.1, 1)
            end
        else
            if not Walked then
                Walked = true
                PlayAnim(Character, Anims.Walk, 0.1, 1)
            end
        end
        Jumped, Falled, Idled = false, false, false
    end
end)

-- Add safety check after "Run away V2" ends
if Anims["Run away V2"] and not Anims["Run away V2"].IsPlaying then
    SafeCheckGroundPosition()
end



-- Self-Healing Rig Fix


-- Auto-fix body parts if they fall apart or drift
task.spawn(function()
    while true do
        if Character and Character:IsDescendantOf(workspace) then
            for _, part in pairs(Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    -- Reset physics
                    part.Velocity = Vector3.zero
                    part.RotVelocity = Vector3.zero
                    part.AssemblyLinearVelocity = Vector3.zero
                    part.AssemblyAngularVelocity = Vector3.zero

                    -- Reset CFrame if detached
                    if (part.Position - Character.HumanoidRootPart.Position).Magnitude > 15 then
                        part.CFrame = Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, -1)
                    end

                    -- Ensure client owns it
                    pcall(function()
                        part:SetNetworkOwner(game.Players.LocalPlayer)
                    end)
                end
            end
        end
        wait(10)
    end
end)

-- Anti-Shake Rig Stabilizer (patched to skip during Run away V2)
task.spawn(function()
    while true do
        local root = Character:FindFirstChild("HumanoidRootPart")
        if root and Character:IsDescendantOf(workspace) then
            if Anims["Run away V2"] and Anims["Run away V2"].IsPlaying then
                -- Skip stabilization during cinematic animation
            else
                local isIdle = (root.Velocity.Magnitude < 0.1 and math.abs(root.Velocity.Y) < 0.1)
                if isIdle then
                    for _, part in pairs(Character:GetDescendants()) do
                        if part:IsA("BasePart") and not part.Anchored then
                            part.Velocity = Vector3.zero
                            part.RotVelocity = Vector3.zero
                            part.AssemblyLinearVelocity = Vector3.zero
                            part.AssemblyAngularVelocity = Vector3.zero
                            if (part.Position - root.Position).Magnitude < 5 then
                                part.CFrame = part.CFrame
                            end
                        end
                    end
                end
            end
        end
        wait(0.2)
    end
end)
task.spawn(function()
	while true do
		if Character and Character:IsDescendantOf(workspace) then
			local root = Character:FindFirstChild("HumanoidRootPart")
			local isIdle = (root.Velocity.Magnitude < 0.1 and math.abs(root.Velocity.Y) < 0.1)

			if isIdle then
				for _, part in pairs(Character:GetDescendants()) do
					if part:IsA("BasePart") and not part.Anchored then
						part.Velocity = Vector3.zero
						part.RotVelocity = Vector3.zero
						part.AssemblyLinearVelocity = Vector3.zero
						part.AssemblyAngularVelocity = Vector3.zero

						-- Slight refresh to kill drift
						if (part.Position - root.Position).Magnitude < 5 then
							part.CFrame = part.CFrame
						end
					end
				end
			end
		end
		wait(0.2)
	end
end)

-- Delay until GUI + Forsaken animations are ready
task.delay(2, function()
    -- âœ… Search bar for Forsaken tab
    local ForsakenSearchBox = Instance.new("TextBox")
    ForsakenSearchBox.PlaceholderText = "Search Forsaken..."
    ForsakenSearchBox.Size = UDim2.new(0, 200, 0, 30)
    ForsakenSearchBox.Position = UDim2.new(0, 20, 0, 100)
    ForsakenSearchBox.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    ForsakenSearchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    ForsakenSearchBox.Text = ""
    ForsakenSearchBox.Parent = game.CoreGui

    local function BuildForsakenTab(filter)
        if not DancesB then return end
        DancesB:Clear()
        for _, v in pairs(Forsaken) do
            if v.Divider then
                DancesB:Line()
            elseif not filter or v.Name:lower():find(filter:lower()) then
                DancesB:Button(v.Name, v.Name, function()
                    if not Anims:FindFirstChild(v.Name) then
                        CreateAnimation(v.Name, v.ID)
                    end
                    PlayAnim(Character, Anims[v.Name], 0, v.Speed or 1)
                end)
            end
        end
    end

    ForsakenSearchBox:GetPropertyChangedSignal("Text"):Connect(function()
        BuildForsakenTab(ForsakenSearchBox.Text)
    end)

    BuildForsakenTab(nil)
end)

-- âœ… Minimize button
local MiniBox = Instance.new("ScreenGui", game.CoreGui)
MiniBox.Name = "MinimizeDisbeliefHub"

local ToggleButton = Instance.new("TextButton")
ToggleButton.Text = "GUI"
ToggleButton.Size = UDim2.new(0, 60, 0, 30)
ToggleButton.Position = UDim2.new(0, 10, 0.5, 0)
ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ToggleButton.TextColor3 = Color3.new(1, 1, 1)
ToggleButton.Draggable = true
ToggleButton.Active = true
ToggleButton.Parent = MiniBox

ToggleButton.MouseButton1Click:Connect(function()
    local Flux = game.CoreGui:FindFirstChild("FluxLib")
    if Flux then
        Flux.Enabled = not Flux.Enabled
    end
end)

-- Hook into animation stop to re-anchor player
task.delay(2, function()
    if Anims["Run away V2"] then
        Anims["Run away V2"].Stopped:Connect(function()
            RootPart.CFrame = RootPart.CFrame + Vector3.new(0, 3, 0)
        end)
    end
end)

loadstring(game:HttpGet("https://raw.githubusercontent.com/Vincent81536/attack/refs/heads/main/attack"))()


-- âœ… Improved Anti-Shake & Rig Stabilizer
task.spawn(function()
    while true do
        if Character and Character:IsDescendantOf(workspace) then
            local root = Character:FindFirstChild("HumanoidRootPart")
            if root then
                for _, part in pairs(Character:GetDescendants()) do
                    if part:IsA("BasePart") and not part.Anchored then
                        part.Velocity = Vector3.zero
                        part.RotVelocity = Vector3.zero
                        part.AssemblyLinearVelocity = Vector3.zero
                        part.AssemblyAngularVelocity = Vector3.zero

                        -- Re-attach far drifting parts
                        if (part.Position - root.Position).Magnitude > 15 then
                            part.CFrame = root.CFrame * CFrame.new(0, 0, -1)
                        end

                        -- Set local network ownership
                        pcall(function()
                            part:SetNetworkOwner(game.Players.LocalPlayer)
                        end)
                    end
                end
            end
        end
        wait(0.2)
    end
end)
